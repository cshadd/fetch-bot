<!DOCTYPE html>
<html itemtype="http://schema.org/WebPage" itemscope="" lang="en-US">
<head>
 <meta charset="utf-8" />
 <meta http-equiv="X-UA-Compatible" content="IE=edge" />
 <meta name="IE_RM_OFF" content="false" />
 <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />
 <link rel="stylesheet" href="includes/common.css" />
 <link rel="stylesheet" href="includes/face.css" />
 <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
 <![endif]-->
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
 <script src="processFromRobot.js"></script>
 <script>
  function eyeBlink() {
    var $eye = $(".eye");
    $eye.animate({
      height: "1px"
    }, 100, function() {
      $eye.animate({
        height: "50px"
      }, 100);
    });
  }



  function setEyeEmotion(color, height, rot) {
    var $eye = $(".eye");
    var $leftEye = $(".eye-left");
    var $rightEye = $(".eye-right");

    $eye.animate({
      height: "" + height
    }, 500, function() {
      $eye.css("background-color", color);
      $eye.css("box-shadow", "0 0 15px 15px " + color)
      $leftEye.css({
        "transform": "rotate(" + rot + "deg)"
      });
      $rightEye.css({
        "transform": "rotate(" + -rot + "deg)"
      });
    });
  }

  setInterval(function() {
    if (data != null) {
    	if (data.emotion == "Angry") {
        	setEyeEmotion("#ff0000", "50px", 35);
        }
        else if (data.emotion == "Happy") {
        	setEyeEmotion("#00ff00", "50px", 0);
        }
        else if (data.emotion == "Neutral") {
        	setEyeEmotion("#fff", "50px", 0);
        }
        else if (data.emotion == "Sad") {
        	setEyeEmotion("#00ffff", "50px", -35);
        }
        else {
        	data.emotion = "Boot";
        	setEyeEmotion("#fff", "10px", 0);
        }

        if (data.emotion != "Boot") {
        	if (Math.floor((Math.random()*10)) <= 3) {
        		eyeMove(Math.floor(Math.random()*10));
        	}
        	if (Math.floor((Math.random()*10)) <= 3) {
        		eyeBlink();
        	}
        }
        else {
        	eyeMove(10);
        }
    }
    else {
    	setEyeEmotion("#ff0000", "10px", 0);
        eyeMove(10);
    }
  }, 1000);
</script>
</html>
 <title>Face</title>
</head>
<body>
 <main>
  <div class="face">
   <div class="eyes">
    <div class="eye eye-left"></div>
    <div class="eye eye-right"></div>
   </div>
  </div>
 </main>
</body>
</html>
