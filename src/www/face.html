<!DOCTYPE html>
<html itemtype="http://schema.org/WebPage" itemscope="" lang="en-US">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="IE_RM_OFF" content="false" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />
    <link rel="stylesheet" href="includes/common.css" />
    <link rel="stylesheet" href="includes/face.css" />
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="readCommunications.js"></script>
    <script>
        function eyeBlink() {
            var $eye = $(".eye");
            $eye.animate({
                height: "1px"
            }, 100, function () {
                $eye.animate({
                    height: "50px"
                }, 100);
            });
        }

        function eyeMove(position) {
            var $eyes = $(".eyes");
            var margins = ["20%", "0", "0", "20%"];
            // Bottom, Left, Right, Top
            if (position == 0) { // Top-Left
                margins[0] = "30%";
                margins[1] = "0";
                margins[2] = "20%";
                margins[3] = "10%";
            }
            else if (position == 1) { // Top
                margins[0] = "30%";
                margins[1] = "0";
                margins[2] = "0";
                margins[3] = "10%";
            }
            else if (position == 2) { // Top-Right
                margins[0] = "30%";
                margins[1] = "20%";
                margins[2] = "0";
                margins[3] = "10%";
            }
            else if (position == 3) { // Right
                margins[0] = "20%";
                margins[1] = "20%";
                margins[2] = "0";
                margins[3] = "20%";
            }
            else if (position == 4) { // Bottom-Right
                margins[0] = "10%";
                margins[1] = "20%";
                margins[2] = "0";
                margins[3] = "30%";
            }
            else if (position == 5) { // Bottom
                margins[0] = "10%";
                margins[1] = "0";
                margins[2] = "0";
                margins[3] = "30%";
            }
            else if (position == 6) { // Bottom-Left
                margins[0] = "10%";
                margins[1] = "0";
                margins[2] = "20%";
                margins[3] = "30%";
            }
            else if (position == 7) { // Left
                margins[0] = "20%";
                margins[1] = "0";
                margins[2] = "20%";
                margins[3] = "20%";
            }
            $eyes.animate({
                marginBottom: "" + margins[0],
                marginLeft: "" + margins[1],
                marginRight: "" + margins[2],
                marginTop: "" + margins[3],
            }, Math.random() * 500);
        }

        function setEyeEmotion(color, height, rot) {
            var $eye = $(".eye");
            var $leftEye = $(".eye-left");
            var $rightEye = $(".eye-right");

            $eye.animate({
                height: "" + height
            }, 500, function () {
                $eye.css("background-color", color);
                $eye.css("box-shadow", "0 0 15px 15px " + color)
                $leftEye.css({
                    "transform": "rotate(" + rot + "deg)"
                });
                $rightEye.css({
                    "transform": "rotate(" + -rot + "deg)"
                });
            });
        }

        setInterval(function () {
            if (data != null) {
                if (data.emotion == "Angry") {
                    setEyeEmotion("#ff0000", "50px", 35);
                    if (Math.floor((Math.random() * 10)) <= 3) {
                        eyeMove(Math.floor(Math.random() * 10));
                    }
                    if (Math.floor((Math.random() * 10)) <= 3) {
                        eyeBlink();
                    }
                }
                else if (data.emotion == "Happy") {
                    setEyeEmotion("#00ff00", "50px", 0);
                    if (Math.floor((Math.random() * 10)) <= 3) {
                        eyeMove(Math.floor(Math.random() * 10));
                    }
                    if (Math.floor((Math.random() * 10)) <= 3) {
                        eyeBlink();
                    }
                }
                else if (data.emotion == "Idle") {
                    setEyeEmotion("#fff", "10px", 0);
                    eyeMove(10);
                }
                else if (data.emotion == "Neutral") {
                    setEyeEmotion("#fff", "50px", 0);
                    if (Math.floor((Math.random() * 10)) <= 3) {
                        eyeMove(Math.floor(Math.random() * 10));
                    }
                    if (Math.floor((Math.random() * 10)) <= 3) {
                        eyeBlink();
                    }
                }
                else if (data.emotion == "Sad") {
                    setEyeEmotion("#00ffff", "50px", -35);
                    if (Math.floor((Math.random() * 10)) <= 3) {
                        eyeMove(Math.floor(Math.random() * 10));
                    }
                    if (Math.floor((Math.random() * 10)) <= 3) {
                        eyeBlink();
                    }
                }
                else {
                    setEyeEmotion("#ff0000", "10px", 0);
                    eyeMove(10);
                }
            }
            else {
                setEyeEmotion("#ff0000", "10px", 0);
                eyeMove(10);
            }
        }, 1000);
    </script>
    <title>Face</title>
</head>
<body>
    <main class="container-fluid">
        <div class="face">
            <div class="eyes">
                <div class="eye eye-left"></div>
                <div class="eye eye-right"></div>
            </div>
        </div>
    </main>
</body>
</html>
